<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Weapons Explorer — Harshit Chaturvedi</title>
  <style>
    :root {
      --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#9fb4ff;
    }
    * { box-sizing:border-box; font-family: Inter, system-ui, sans-serif; }
    body { margin:0; background:linear-gradient(180deg,#071025,#06131d); color:#e6eef8; }
    header { padding:20px; text-align:center; }
    h1 { margin:0; font-size:22px; }
    nav { display:flex; justify-content:center; flex-wrap:wrap; gap:10px; margin-top:12px; }
    nav button, select {
      padding:10px 14px; border:0; border-radius:8px; cursor:pointer;
      font-weight:600; background:var(--card); color:#e6eef8;
    }
    nav button.active { background:var(--accent); color:#03102a; }
    main { padding:16px 20px; }
    .grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:16px; }
    .card { background:rgba(255,255,255,0.03); padding:12px; border-radius:12px; display:flex; gap:12px; }
    .thumb { width:100px; height:70px; background:#081225; border-radius:8px; flex-shrink:0; display:flex; align-items:center; justify-content:center; overflow:hidden; }
    .thumb img { width:100%; height:100%; object-fit:cover; }
    .meta { flex:1; }
    .title { font-size:15px; margin:0 0 6px; }
    .desc { font-size:13px; color:var(--muted); line-height:1.3; max-height:40px; overflow:hidden; }
    footer { padding:14px 20px; color:var(--muted); font-size:13px; border-top:1px solid rgba(255,255,255,0.05); text-align:center; }
    .searchbox { display:flex; justify-content:center; gap:8px; margin-top:16px; }
    .searchbox input { padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.1); background:transparent; color:#e6eef8; width:200px; }
    .searchbox button { background:var(--accent); color:#03102a; }
  </style>
</head>
<body>
  <header>
    <h1>Weapons Explorer</h1>
    <div style="font-size:13px;color:var(--muted)">
      Army • Air Force • Navy • Countries — Powered by Wikipedia • Author: <b>Harshit Chaturvedi</b>
    </div>
    <nav>
      <button data-cat="Category:Infantry weapons" class="active">Army</button>
      <button data-cat="Category:Military aircraft">Air Force</button>
      <button data-cat="Category:Naval ships">Navy</button>
      <select id="countrySelect">
        <option value="">-- Select Country --</option>
        <option value="Category:Weapons of India">India</option>
        <option value="Category:Weapons of the United States">USA</option>
        <option value="Category:Weapons of Russia">Russia</option>
        <option value="Category:Weapons of China">China</option>
        <option value="Category:Weapons of France">France</option>
        <option value="Category:Weapons of Germany">Germany</option>
        <option value="Category:Weapons of the United Kingdom">UK</option>
        <option value="Category:Weapons of Israel">Israel</option>
      </select>
    </nav>
    <div class="searchbox">
      <input type="text" id="q" placeholder="Search any weapon e.g. AK-47, F-16" />
      <button id="searchBtn">Search</button>
    </div>
  </header>

  <main>
    <div id="results" class="grid"></div>
    <div id="status" style="margin-top:16px;color:var(--muted)"></div>
  </main>

  <footer>
    Data from Wikipedia (CC BY-SA). Informational only. © Harshit Chaturvedi
  </footer>

  <script>
    const results = document.getElementById('results');
    const status = document.getElementById('status');
    const buttons = document.querySelectorAll('nav button');
    const countrySelect = document.getElementById('countrySelect');
    const searchBtn = document.getElementById('searchBtn');
    const qinput = document.getElementById('q');

    async function fetchCategory(cat){
      status.textContent = "Loading " + cat + " ...";
      results.innerHTML = "";
      try {
        const url = `https://en.wikipedia.org/w/api.php?origin=*&action=query&format=json&list=categorymembers&cmtitle=${encodeURIComponent(cat)}&cmlimit=15`;
        const res = await fetch(url);
        const data = await res.json();
        const pages = data.query.categorymembers;
        if(!pages.length){ status.textContent="No results."; return; }

        const ids = pages.map(p=>p.pageid).join("|");
        const detailUrl = `https://en.wikipedia.org/w/api.php?origin=*&format=json&action=query&pageids=${ids}&prop=extracts|pageimages|info&exintro=1&explaintext=1&piprop=thumbnail&pithumbsize=400&inprop=url`;
        const detailRes = await fetch(detailUrl);
        const detailData = await detailRes.json();
        const detailPages = detailData.query.pages;

        Object.values(detailPages).forEach(p => results.appendChild(makeCard(p)));
        status.textContent = `Showing ${pages.length} results from ${cat}`;
      } catch (err) {
        console.error(err);
        status.textContent = "Error fetching data.";
      }
    }

    async function wikiSearch(query){
      status.textContent = "Searching for " + query + "...";
      results.innerHTML = "";
      try {
        const url = `https://en.wikipedia.org/w/api.php?origin=*&format=json&action=query&list=search&srsearch=${encodeURIComponent(query)}&srlimit=15`;
        const res = await fetch(url);
        const data = await res.json();
        const hits = data.query.search;
        if(!hits.length){ status.textContent="No results."; return; }
        const ids = hits.map(h=>h.pageid).join("|");
        const detailUrl = `https://en.wikipedia.org/w/api.php?origin=*&format=json&action=query&pageids=${ids}&prop=extracts|pageimages|info&exintro=1&explaintext=1&piprop=thumbnail&pithumbsize=400&inprop=url`;
        const detailRes = await fetch(detailUrl);
        const detailData = await detailRes.json();
        const detailPages = detailData.query.pages;
        Object.values(detailPages).forEach(p => results.appendChild(makeCard(p)));
        status.textContent = `Showing ${hits.length} results.`;
      } catch(err){
        console.error(err);
        status.textContent="Error searching.";
      }
    }

    function makeCard(page){
      const el = document.createElement('div'); el.className='card';
      const thumb = document.createElement('div'); thumb.className='thumb';
      if(page.thumbnail && page.thumbnail.source){
        const img=document.createElement('img'); img.src=page.thumbnail.source; img.alt=page.title;
        thumb.appendChild(img);
      } else {
        thumb.textContent="No image";
      }
      const meta=document.createElement('div'); meta.className='meta';
      const title=document.createElement('h3'); title.className='title'; title.textContent=page.title;
      const desc=document.createElement('div'); desc.className='desc'; desc.textContent=page.extract || "No summary.";
      const link=document.createElement('a'); link.href=page.fullurl; link.target="_blank"; link.textContent="Read more"; link.style="font-size:12px;display:block;margin-top:6px;color:var(--accent)";
      meta.appendChild(title); meta.appendChild(desc); meta.appendChild(link);
      el.appendChild(thumb); el.appendChild(meta);
      return el;
    }

    // Category buttons
    buttons.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        buttons.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        countrySelect.value = ""; // reset country
        fetchCategory(btn.dataset.cat);
      });
    });

    // Country dropdown
    countrySelect.addEventListener('change', ()=>{
      if(countrySelect.value){
        buttons.forEach(b=>b.classList.remove('active'));
        fetchCategory(countrySelect.value);
      }
    });

    // Search
    searchBtn.addEventListener('click', ()=>{ if(qinput.value.trim()) wikiSearch(qinput.value.trim()); });
    qinput.addEventListener('keydown', e=>{ if(e.key==="Enter" && qinput.value.trim()) wikiSearch(qinput.value.trim()); });

    // Load default (Army)
    fetchCategory("Category:Infantry weapons");
  </script>
</body>
</html>
